(function(e){var a=[];var f={options:{prependExistingHelpBlock:false,sniffHtml:true,preventSubmit:true,submitError:false,submitSuccess:false,semanticallyStrict:false,bindEvents:[],autoAdd:{helpBlocks:true},filter:function(){return true}},methods:{init:function(i){var j=e.extend(true,{},f);j.options=e.extend(true,j.options,i);var k=this;var h=e.unique(k.map(function(){return e(this).parents("form")[0]}).toArray());e(h).bind("submit.validationSubmit",function(p){var l=e(this);var q=0;var o=l.find("input,textarea,select").not("[type=submit],[type=image]").filter(j.options.filter);var n=l.find(".control-group");var m=o.filter(function(){return e(this).triggerHandler("getValidatorCount.validation")>0});m.trigger("submit.validation");o.trigger("validationLostFocus.validation");n.each(function(r,s){var t=e(s);if(t.hasClass("warning")||t.hasClass("error")){t.removeClass("warning").addClass("error");q++}});if(q){if(j.options.preventSubmit){p.preventDefault();p.stopImmediatePropagation()}l.addClass("error");if(e.isFunction(j.options.submitError)){j.options.submitError(l,p,m.jqBootstrapValidation("collectErrors",true))}}else{l.removeClass("error");if(e.isFunction(j.options.submitSuccess)){j.options.submitSuccess(l,p)}}});return this.each(function(){var u=e(this),s=u.parents(".control-group").first(),x=s.find(".help-block").first(),A=u.parents("form").first(),l=[];if(!x.length&&j.options.autoAdd&&j.options.autoAdd.helpBlocks){x=e('<div class="help-block" />');s.find(".controls").append(x);a.push(x[0])}if(j.options.sniffHtml){var z;if(u.data("validationPatternPattern")){u.attr("pattern",u.data("validationPatternPattern"))}if(u.attr("pattern")!==undefined){z="格式不正确<!-- data-validation-pattern-message to override -->";if(u.data("validationPatternMessage")){z=u.data("validationPatternMessage")}u.data("validationPatternMessage",z);u.data("validationPatternRegex",u.attr("pattern"))}if(u.attr("max")!==undefined||u.attr("aria-valuemax")!==undefined){var w=(u.attr("max")!==undefined?u.attr("max"):u.attr("aria-valuemax"));z="不能大于 '"+w+"'<!-- data-validation-max-message to override -->";if(u.data("validationMaxMessage")){z=u.data("validationMaxMessage")}u.data("validationMaxMessage",z);u.data("validationMaxMax",w)}if(u.attr("min")!==undefined||u.attr("aria-valuemin")!==undefined){var p=(u.attr("min")!==undefined?u.attr("min"):u.attr("aria-valuemin"));z="不能小于 '"+p+"'<!-- data-validation-min-message to override -->";if(u.data("validationMinMessage")){z=u.data("validationMinMessage")}u.data("validationMinMessage",z);u.data("validationMinMin",p)}if(u.attr("maxlength")!==undefined){z="最多 '"+u.attr("maxlength")+"' 个字符<!-- data-validation-maxlength-message to override -->";if(u.data("validationMaxlengthMessage")){z=u.data("validationMaxlengthMessage")}u.data("validationMaxlengthMessage",z);u.data("validationMaxlengthMaxlength",u.attr("maxlength"))}if(u.attr("minlength")!==undefined){z="最少 '"+u.attr("minlength")+"' 个字符<!-- data-validation-minlength-message to override -->";if(u.data("validationMinlengthMessage")){z=u.data("validationMinlengthMessage")}u.data("validationMinlengthMessage",z);u.data("validationMinlengthMinlength",u.attr("minlength"))}if(u.attr("required")!==undefined||u.attr("aria-required")!==undefined){z=j.builtInValidators.required.message;if(u.data("validationRequiredMessage")){z=u.data("validationRequiredMessage")}u.data("validationRequiredMessage",z)}if(u.attr("type")!==undefined&&u.attr("type").toLowerCase()==="number"){z=j.validatorTypes.number.message;if(u.data("validationNumberMessage")){z=u.data("validationNumberMessage")}u.data("validationNumberMessage",z);var m=j.validatorTypes.number.step;if(u.data("validationNumberStep")){m=u.data("validationNumberStep")}u.data("validationNumberStep",m);var r=j.validatorTypes.number.decimal;if(u.data("validationNumberDecimal")){r=u.data("validationNumberDecimal")}u.data("validationNumberDecimal",r)}if(u.attr("type")!==undefined&&u.attr("type").toLowerCase()==="email"){z="不正确的 Email 格式<!-- data-validation-email-message to override -->";if(u.data("validationEmailMessage")){z=u.data("validationEmailMessage")}u.data("validationEmailMessage",z)}if(u.attr("minchecked")!==undefined){z="Not enough options checked; Minimum of '"+u.attr("minchecked")+"' required<!-- data-validation-minchecked-message to override -->";if(u.data("validationMincheckedMessage")){z=u.data("validationMincheckedMessage")}u.data("validationMincheckedMessage",z);u.data("validationMincheckedMinchecked",u.attr("minchecked"))}if(u.attr("maxchecked")!==undefined){z="Too many options checked; Maximum of '"+u.attr("maxchecked")+"' required<!-- data-validation-maxchecked-message to override -->";if(u.data("validationMaxcheckedMessage")){z=u.data("validationMaxcheckedMessage")}u.data("validationMaxcheckedMessage",z);u.data("validationMaxcheckedMaxchecked",u.attr("maxchecked"))}}if(u.data("validation")!==undefined){l=u.data("validation").split(",")}e.each(u.data(),function(B,C){var D=B.replace(/([A-Z])/g,",$1").split(",");if(D[0]==="validation"&&D[1]){l.push(D[1])}});var q=l;var v=[];var t=function(B,C){l[B]=d(C)};var o=function(C,D){if(u.data("validation"+D+"Shortcut")!==undefined){e.each(u.data("validation"+D+"Shortcut").split(","),function(F,E){v.push(E)})}else{if(j.builtInValidators[D.toLowerCase()]){var B=j.builtInValidators[D.toLowerCase()];if(B.type.toLowerCase()==="shortcut"){e.each(B.shortcut.split(","),function(E,F){F=d(F);v.push(F);l.push(F)})}}}};do{e.each(l,t);l=e.unique(l);v=[];e.each(q,o);q=v}while(q.length>0);var n={};e.each(l,function(C,E){var F=u.data("validation"+E+"Message");var H=!!F;var D=false;if(!F){F="'"+E+"' validation failed <!-- Add attribute 'data-validation-"+E.toLowerCase()+"-message' to input to change this message -->"}e.each(j.validatorTypes,function(I,K){if(n[I]===undefined){n[I]=[]}if(!D&&u.data("validation"+E+d(K.name))!==undefined){var J=K.init(u,E);if(H){J.message=F}n[I].push(e.extend(true,{name:d(K.name),message:F},J));D=true}});if(!D&&j.builtInValidators[E.toLowerCase()]){var B=e.extend(true,{},j.builtInValidators[E.toLowerCase()]);if(H){B.message=F}var G=B.type.toLowerCase();if(G==="shortcut"){D=true}else{e.each(j.validatorTypes,function(I,J){if(n[I]===undefined){n[I]=[]}if(!D&&G===I.toLowerCase()){u.data("validation"+E+d(J.name),B[J.name.toLowerCase()]);n[G].push(e.extend(B,J.init(u,E)));D=true}})}}if(!D){e.error("Cannot find validation info for '"+E+"'")}});x.data("original-contents",(x.data("original-contents")?x.data("original-contents"):x.html()));x.data("original-role",(x.data("original-role")?x.data("original-role"):x.attr("role")));s.data("original-classes",(s.data("original-clases")?s.data("original-classes"):s.attr("class")));u.data("original-aria-invalid",(u.data("original-aria-invalid")?u.data("original-aria-invalid"):u.attr("aria-invalid")));u.bind("validation.validation",function(C,E){var D=c(u);var B=[];e.each(n,function(F,G){if(D||D.length||((E&&E.includeEmpty)||!!j.validatorTypes[F].includeEmpty)||(!!j.validatorTypes[F].blockSubmit&&E&&!!E.submitting)){e.each(G,function(I,H){if(j.validatorTypes[F].validate(u,D,H)){B.push(H.message)}})}});return B});u.bind("getValidators.validation",function(){return n});var y=0;e.each(n,function(B,C){y+=C.length});u.bind("getValidatorCount.validation",function(){return y});u.bind("submit.validation",function(){return u.triggerHandler("change.validation",{submitting:true})});u.bind((j.options.bindEvents.length>0?j.options.bindEvents:["keyup","focus","blur","click","keydown","keypress","change"]).concat(["revalidate"]).join(".validation ")+".validation",function(E,F){var D=c(u);var C=[];if(F&&!!F.submitting){s.data("jqbvIsSubmitting",true)}else{if(E.type!=="revalidate"){s.data("jqbvIsSubmitting",false)}}var B=!!s.data("jqbvIsSubmitting");s.find("input,textarea,select").each(function(I,J){var G=C.length;e.each(e(J).triggerHandler("validation.validation",F),function(K,L){C.push(L)});if(C.length>G){e(J).attr("aria-invalid","true")}else{var H=u.data("original-aria-invalid");e(J).attr("aria-invalid",(H!==undefined?H:false))}});A.find("input,select,textarea").not(u).not('[name="'+u.attr("name")+'"]').trigger("validationLostFocus.validation");C=e.unique(C.sort());if(C.length){s.removeClass("success error warning").addClass(B?"error":"warning");if(j.options.semanticallyStrict&&C.length===1){x.html(C[0]+(j.options.prependExistingHelpBlock?x.data("original-contents"):""))}else{x.html('<ul role="alert"><li>'+C.join("</li><li>")+"</li></ul>"+(j.options.prependExistingHelpBlock?x.data("original-contents"):""))}}else{s.removeClass("warning error success");if(D.length>0){s.addClass("success")}x.html(x.data("original-contents"))}if(E.type==="blur"){s.removeClass("success")}});u.bind("validationLostFocus.validation",function(){s.removeClass("success")})})},destroy:function(){return this.each(function(){var i=e(this),k=i.parents(".control-group").first(),j=k.find(".help-block").first(),h=i.parents("form").first();i.unbind(".validation");h.unbind(".validationSubmit");j.html(j.data("original-contents"));k.attr("class",k.data("original-classes"));i.attr("aria-invalid",i.data("original-aria-invalid"));j.attr("role",i.data("original-role"));if(e.inArray(j[0],a)>-1){j.remove()}})},collectErrors:function(h){var i={};this.each(function(l,m){var k=e(m);var j=k.attr("name");var n=k.triggerHandler("validation.validation",{includeEmpty:true});i[j]=e.extend(true,n,i[j])});e.each(i,function(j,k){if(k.length===0){delete i[j]}});return i},hasErrors:function(){var h=[];this.find("input,select,textarea").add(this).each(function(j,k){h=h.concat(e(k).triggerHandler("getValidators.validation")?e(k).triggerHandler("validation.validation",{submitting:true}):[])});return(h.length>0)},override:function(h){f=e.extend(true,f,h)}},validatorTypes:{callback:{name:"callback",init:function(k,i){var h={validatorName:i,callback:k.data("validation"+i+"Callback"),lastValue:k.val(),lastValid:true,lastFinished:true};var j="Not valid";if(k.data("validation"+i+"Message")){j=k.data("validation"+i+"Message")}h.message=j;return h},validate:function(k,j,i){if(i.lastValue===j&&i.lastFinished){return!i.lastValid}if(i.lastFinished===true){i.lastValue=j;i.lastValid=true;i.lastFinished=false;var l=i;var h=k;b(i.callback,window,k,j,function(m){if(l.lastValue===m.value){l.lastValid=m.valid;if(m.message){l.message=m.message}l.lastFinished=true;h.data("validation"+l.validatorName+"Message",l.message);setTimeout(function(){if(!k.is(":focus")&&k.parents("form").first().data("jqbvIsSubmitting")){h.trigger("blur.validation")}else{h.trigger("revalidate.validation")}},1)}})}return false}},ajax:{name:"ajax",init:function(i,h){return{validatorName:h,url:i.data("validation"+h+"Ajax"),lastValue:i.val(),lastValid:true,lastFinished:true}},validate:function(j,i,h){if(""+h.lastValue===""+i&&h.lastFinished===true){return h.lastValid===false}if(h.lastFinished===true){h.lastValue=i;h.lastValid=true;h.lastFinished=false;e.ajax({url:h.url,data:"value="+encodeURIComponent(i)+"&field="+j.attr("name"),dataType:"json",success:function(k){if(""+h.lastValue===""+k.value){h.lastValid=!!(k.valid);if(k.message){h.message=k.message}h.lastFinished=true;j.data("validation"+h.validatorName+"Message",h.message);setTimeout(function(){j.trigger("revalidate.validation")},1)}},failure:function(){h.lastValid=true;h.message="ajax call failed";h.lastFinished=true;j.data("validation"+h.validatorName+"Message",h.message);setTimeout(function(){j.trigger("revalidate.validation")},1)}})}return false}},regex:{name:"regex",init:function(l,j){var h={};var i=l.data("validation"+j+"Regex");h.regex=g(i);if(i===undefined){e.error("Can't find regex for '"+j+"' validator on '"+l.attr("name")+"'")}var k="Not in the expected format";if(l.data("validation"+j+"Message")){k=l.data("validation"+j+"Message")}h.message=k;h.originalName=j;return h},validate:function(j,i,h){return(!h.regex.test(i)&&!h.negative)||(h.regex.test(i)&&h.negative)}},email:{name:"email",init:function(k,i){var h={};h.regex=g("[a-zA-Z0-9.!#$%&\u2019*+/=?^_`{|}~-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,4}");var j="Not a valid email address";if(k.data("validation"+i+"Message")){j=k.data("validation"+i+"Message")}h.message=j;h.originalName=i;return h},validate:function(j,i,h){return(!h.regex.test(i)&&!h.negative)||(h.regex.test(i)&&h.negative)}},required:{name:"required",init:function(j,h){var i="This is required";if(j.data("validation"+h+"Message")){i=j.data("validation"+h+"Message")}return{message:i,includeEmpty:true}},validate:function(j,i,h){return!!((i.length===0&&!h.negative)||(i.length>0&&h.negative))},blockSubmit:true},match:{name:"match",init:function(o,m){var j=o.data("validation"+m+"Match");var l=o.parents("form").first();var k=l.find('[name="'+j+'"]').first();k.bind("validation.validation",function(){o.trigger("revalidate.validation",{submitting:true})});var i={};i.element=k;if(k.length===0){e.error("Can't find field '"+j+"' to match '"+o.attr("name")+"' against in '"+m+"' validator")}var n="Must match";var h=null;if((h=l.find('label[for="'+j+'"]')).length){n+=" '"+h.text()+"'"}else{if((h=k.parents(".control-group").first().find("label")).length){n+=" '"+h.first().text()+"'"}}if(o.data("validation"+m+"Message")){n=o.data("validation"+m+"Message")}i.message=n;return i},validate:function(j,i,h){return(i!==h.element.val()&&!h.negative)||(i===h.element.val()&&h.negative)},blockSubmit:true,includeEmpty:true},max:{name:"max",init:function(j,i){var h={};h.max=j.data("validation"+i+"Max");h.message="Too high: Maximum of '"+h.max+"'";if(j.data("validation"+i+"Message")){h.message=j.data("validation"+i+"Message")}return h},validate:function(j,i,h){return(parseFloat(i,10)>parseFloat(h.max,10)&&!h.negative)||(parseFloat(i,10)<=parseFloat(h.max,10)&&h.negative)}},min:{name:"min",init:function(j,i){var h={};h.min=j.data("validation"+i+"Min");h.message="Too low: Minimum of '"+h.min+"'";if(j.data("validation"+i+"Message")){h.message=j.data("validation"+i+"Message")}return h},validate:function(j,i,h){return(parseFloat(i)<parseFloat(h.min)&&!h.negative)||(parseFloat(i)>=parseFloat(h.min)&&h.negative)}},maxlength:{name:"maxlength",init:function(j,i){var h={};h.maxlength=j.data("validation"+i+"Maxlength");h.message="Too long: Maximum of '"+h.maxlength+"' characters";if(j.data("validation"+i+"Message")){h.message=j.data("validation"+i+"Message")}return h},validate:function(j,i,h){return((i.length>h.maxlength)&&!h.negative)||((i.length<=h.maxlength)&&h.negative)}},minlength:{name:"minlength",init:function(j,i){var h={};h.minlength=j.data("validation"+i+"Minlength");h.message="Too short: Minimum of '"+h.minlength+"' characters";if(j.data("validation"+i+"Message")){h.message=j.data("validation"+i+"Message")}return h},validate:function(j,i,h){return((i.length<h.minlength)&&!h.negative)||((i.length>=h.minlength)&&h.negative)}},maxchecked:{name:"maxchecked",init:function(l,i){var h={};var k=l.parents("form").first().find('[name="'+l.attr("name")+'"]');k.bind("change.validation click.validation",function(){l.trigger("revalidate.validation",{includeEmpty:true})});h.elements=k;h.maxchecked=l.data("validation"+i+"Maxchecked");var j="Too many: Max '"+h.maxchecked+"' checked";if(l.data("validation"+i+"Message")){j=l.data("validation"+i+"Message")}h.message=j;return h},validate:function(j,i,h){return(h.elements.filter(":checked").length>h.maxchecked&&!h.negative)||(h.elements.filter(":checked").length<=h.maxchecked&&h.negative)},blockSubmit:true},minchecked:{name:"minchecked",init:function(l,i){var h={};var k=l.parents("form").first().find('[name="'+l.attr("name")+'"]');k.bind("change.validation click.validation",function(){l.trigger("revalidate.validation",{includeEmpty:true})});h.elements=k;h.minchecked=l.data("validation"+i+"Minchecked");var j="Too few: Min '"+h.minchecked+"' checked";if(l.data("validation"+i+"Message")){j=l.data("validation"+i+"Message")}h.message=j;return h},validate:function(j,i,h){return(h.elements.filter(":checked").length<h.minchecked&&!h.negative)||(h.elements.filter(":checked").length>=h.minchecked&&h.negative)},blockSubmit:true,includeEmpty:true},number:{name:"number",init:function(k,j){var h={};h.step=1;if(k.attr("step")){h.step=k.attr("step")}if(k.data("validation"+j+"Step")){h.step=k.data("validation"+j+"Step")}h.decimal=".";if(k.data("validation"+j+"Decimal")){h.decimal=k.data("validation"+j+"Decimal")}h.thousands="";if(k.data("validation"+j+"Thousands")){h.thousands=k.data("validation"+j+"Thousands")}h.regex=g("([+-]?\\d+(\\"+h.decimal+"\\d+)?)?");h.message="Must be a number";var i=k.data("validation"+j+"Message");if(i){h.message=i}return h},validate:function(m,o,h){var i=o.replace(h.decimal,".").replace(h.thousands,"");var j=parseFloat(i);var n=parseFloat(h.step);while(n%1!==0){n=parseFloat(n.toPrecision(12))*10;j=parseFloat(j.toPrecision(12))*10}var l=h.regex.test(o);var k=parseFloat(j)%parseFloat(n)===0;var p=!isNaN(parseFloat(i))&&isFinite(i);var q=!(l&&k&&p);return q},message:"Must be a number"}},builtInValidators:{email:{name:"Email",type:"email"},passwordagain:{name:"Passwordagain",type:"match",match:"password",message:"Does not match the given password<!-- data-validator-paswordagain-message to override -->"},positive:{name:"Positive",type:"shortcut",shortcut:"number,positivenumber"},negative:{name:"Negative",type:"shortcut",shortcut:"number,negativenumber"},integer:{name:"Integer",type:"regex",regex:"[+-]?\\d+",message:"No decimal places allowed<!-- data-validator-integer-message to override -->"},positivenumber:{name:"Positivenumber",type:"min",min:0,message:"Must be a positive number<!-- data-validator-positivenumber-message to override -->"},negativenumber:{name:"Negativenumber",type:"max",max:0,message:"Must be a negative number<!-- data-validator-negativenumber-message to override -->"},required:{name:"Required",type:"required",message:"This is required<!-- data-validator-required-message to override -->"},checkone:{name:"Checkone",type:"minchecked",minchecked:1,message:"Check at least one option<!-- data-validation-checkone-message to override -->"},number:{name:"Number",type:"number",decimal:".",step:"1"},pattern:{name:"Pattern",type:"regex",message:"Not in expected format"}}};var d=function(h){return h.toLowerCase().replace(/(^|\s)([a-z])/g,function(i,k,j){return k+j.toUpperCase()})};var c=function(l){var k=null;var i=l.attr("type");if(i==="checkbox"){k=(l.is(":checked")?k:"");var h=l.parents("form").first()||l.parents(".control-group").first();if(h){k=h.find("input[name='"+l.attr("name")+"']:checked").map(function(m,n){return e(n).val()}).toArray().join(",")}}else{if(i==="radio"){k=(e('input[name="'+l.attr("name")+'"]:checked').length>0?l.val():"");var j=l.parents("form").first()||l.parents(".control-group").first();if(j){k=j.find("input[name='"+l.attr("name")+"']:checked").map(function(m,n){return e(n).val()}).toArray().join(",")}}else{k=l.val()}}return k};function g(h){return new RegExp("^"+h+"$")}function b(n,k){var h=Array.prototype.slice.call(arguments,2);var m=n.split(".");var l=m.pop();for(var j=0;j<m.length;j++){k=k[m[j]]}return k[l].apply(k,h)}e.fn.jqBootstrapValidation=function(h){if(f.methods[h]){return f.methods[h].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof h==="object"||!h){return f.methods.init.apply(this,arguments)}else{e.error("Method "+h+" does not exist on jQuery.jqBootstrapValidation");return null}}};e.jqBootstrapValidation=function(h){e(":input").not("[type=image],[type=submit]").jqBootstrapValidation.apply(this,arguments)}})(jQuery);